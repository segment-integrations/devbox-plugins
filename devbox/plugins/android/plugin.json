{
  "name": "android",
  "version": "0.0.1",
  "description": "Sets Android home/AVD paths inside the Devbox virtenv for reproducible, project-local Android tooling.",
  "env": {
    "ANDROID_USER_HOME": "{{ .Virtenv }}/android",
    "ANDROID_AVD_HOME": "{{ .Virtenv }}/android/avd",
    "ANDROID_EMULATOR_HOME": "{{ .Virtenv }}/android",
    "ANDROID_CONFIG_DIR": "{{ .DevboxDir }}",
    "ANDROID_DEVICES_DIR": "{{ .DevboxDir }}/devices",
    "ANDROID_SCRIPTS_DIR": "{{ .Virtenv }}/scripts"
  },
  "packages": {
    "bash": "latest",
    "coreutils": "latest",
    "gnused": "latest",
    "gnugrep": "latest",
    "gawk": "latest",
    "jq": "latest",
    "jdk17": "latest",
    "gradle": "latest",
    "path:{{ .DevboxDir }}#android-sdk": ""
  },
  "create_files": {
    "{{ .Virtenv }}/android": "",
    "{{ .Virtenv }}/android/avd": "",
    "{{ .Virtenv }}/process-compose.yaml": "config/process-compose.yaml",
    "{{ .Virtenv }}/scripts/env.sh": "scripts/env.sh",
    "{{ .Virtenv }}/scripts/lib.sh": "scripts/lib.sh",
    "{{ .Virtenv }}/scripts/avd.sh": "scripts/avd.sh",
    "{{ .Virtenv }}/scripts/emulator.sh": "scripts/emulator.sh",
    "{{ .Virtenv }}/scripts/deploy.sh": "scripts/deploy.sh",
    "{{ .Virtenv }}/scripts/android.sh": "scripts/android.sh",
    "{{ .Virtenv }}/scripts/devices.sh": "scripts/devices.sh",
    "{{ .Virtenv }}/scripts/validate.sh": "scripts/validate.sh",
    "{{ .Virtenv }}/config/android.json": "config/android.json",
    "{{ .DevboxDir }}/devices/min.json": "config/devices/min.json",
    "{{ .DevboxDir }}/devices/max.json": "config/devices/max.json",
    "{{ .DevboxDir }}/devices.lock.json": "config/devices.lock.json",
    "{{ .DevboxDir }}/android.json": "config/android.json",
    "{{ .DevboxDir }}/flake.nix": "config/flake.nix",
    "{{ .DevboxDir }}/flake.lock": "config/flake.lock"
  },
  "shell": {
    "init_hook": [
      ". {{ .Virtenv }}/scripts/env.sh"
    ],
    "scripts": {
      "build-android": [
        "echo 'Building Android app...'",
        "gradle assembleDebug --info"
      ],
      "build-android-debug": [
        "echo 'Building Android app with debug output...'",
        "gradle assembleDebug --debug --stacktrace"
      ],
      "test-android": [
        "gradle test"
      ],
      "test-android-e2e": [
        "echo 'Starting Android E2E tests...'",
        ". {{ .Virtenv }}/scripts/avd.sh",
        "android_start_emulator \"${1:-}\"",
        "gradle connectedAndroidTest",
        "android_stop_emulator"
      ],
      "start-emu": [
        ". {{ .Virtenv }}/scripts/avd.sh",
        "android_start_emulator \"${1:-}\""
      ],
      "start-android": [
        ". {{ .Virtenv }}/scripts/avd.sh",
        "android_run_app \"${1-}\""
      ],
      "stop-emu": [
        ". {{ .Virtenv }}/scripts/avd.sh",
        "android_stop_emulator"
      ],
      "reset-emu": [
        "echo 'Resetting Android emulators...'",
        ". {{ .Virtenv }}/scripts/avd.sh",
        "android_stop_emulator",
        "android_reset_avds"
      ]
    }
  }
}
