{
  "include": ["path:../../plugins/android/plugin.json"],
  "packages": {
    "jdk17": "latest",
    "gradle": "latest"
  },
  "env": {
    "ANDROID_APP_ID": "com.example.devbox",
    "ANDROID_APP_APK": "app/build/outputs/apk/debug/app-debug.apk"
  },
  "shell": {
    "scripts": {
      "build": [
        "echo 'Building Android app...'",
        "gradle assembleDebug --info"
      ],
      "start:emu": [
        "android.sh emulator start ${1:-${ANDROID_DEFAULT_DEVICE:-max}}"
      ],
      "stop:emu": [
        "android.sh emulator stop"
      ],
      "start:android": [
        "android.sh emulator start ${1:-${ANDROID_DEFAULT_DEVICE:-max}}",
        "adb install -r ${ANDROID_APP_APK}",
        "adb shell am start -n ${ANDROID_APP_ID}/.MainActivity"
      ],
      "deploy": [
        "devbox run build",
        "devbox run start:android"
      ],
      "test": [
        "gradle test"
      ],
      "test:e2e": [
        "process-compose -f tests/test-suite.yaml --no-server --tui=${TEST_TUI:-false}"
      ],
      "test:e2e:debug": [
        "ANDROID_DEBUG_SETUP=1 process-compose -f tests/test-suite.yaml --no-server --tui=false --log-level=debug"
      ],
      "test:e2e:simple": [
        "echo 'Testing if process-compose works at all...' && process-compose --version"
      ]
    }
  }
}
