version = 1

[install]
cocoapods.pkg-path = "cocoapods"
cocoapods.systems = ["x86_64-darwin", "aarch64-darwin"]
jq.pkg-path = "jq"

[vars]
IOS_SIM_DEVICE = "iPhone 17"
IOS_RUNTIME = "26.1"
IOS_SIMULATOR_SERVICE = "ios-simulator-max"

[hook]
 on-activate = '''
  unset NIX_CFLAGS_COMPILE NIX_LDFLAGS NIX_CFLAGS_LINK LIBRARY_PATH
  export PROJECT_ROOT="${PROJECT_ROOT:-$(git rev-parse --show-toplevel 2>/dev/null || pwd)}"

  if [ -z "${IOS_ENV_INFO_PRINTED:-}" ]; then
    xcode_path=""
    if command -v xcode-select >/dev/null 2>&1; then
      xcode_path="$(xcode-select -p 2>/dev/null || true)"
    fi
    echo
    echo "iOS env:"
    echo "  Xcode=${xcode_path:-unknown}"
    echo "  IOS_SIM_DEVICE=${IOS_SIM_DEVICE:-}"
    echo "  IOS_RUNTIME=${IOS_RUNTIME:-}"
    echo "  IOS_SIMULATOR_SERVICE=${IOS_SIMULATOR_SERVICE:-}"
    echo
    IOS_ENV_INFO_PRINTED=1
  fi
 '''

[profile]
bash = '''
  ios_reset() {
    xcrun simctl shutdown all >/dev/null 2>&1 || true
    xcrun simctl erase all >/dev/null 2>&1 || true
    echo "iOS simulators erased."
  }
  alias ios-reset=ios_reset
'''

zsh = '''
  ios_reset() {
    xcrun simctl shutdown all >/dev/null 2>&1 || true
    xcrun simctl erase all >/dev/null 2>&1 || true
    echo "iOS simulators erased."
  }
  alias ios-reset=ios_reset
'''

[services]

[include]
environments = []

[build]

[options]
